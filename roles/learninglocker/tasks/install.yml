---


- name: Create LearningLocker directory
  file: path="{{ ll_path }}" owner="{{ ansible_ssh_user }}" state=directory
  become: True
  tags:
   - learninglocker
   - directory


- name: Clone LearningLocker
  git:
    repo: https://github.com/LearningLocker/learninglocker.git
    dest: "{{ ll_path }}"
  tags:
   - git
   - clone
   - learninglocker


- name: Avoid using git (just in case it is blocked by the firewall)
  command: git config --global url."https://".insteadOf git://
  tags:
    - git
    - config


- name: Set up Github OAuth key
  command: composer config -g github-oauth.github.com {{ github_token }}
  when: github_token != "false"
  tags:
   - github
   - token
   - oauth
   - composer


- name: Install LearningLocker
  shell: composer install chdir="{{ ll_path }}"
  tags:
   - install
   - learninglocker
